{
  "hash": "11bfbcbb1fc39dcf35481ad4b6e294b0",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: 'Minimizing mse tends to mean, MAE tends to median'\nauthor: Chris Kelly\ndate: 02-08-24\ncategories:\n  - differentation\n  - cost functions\n  - MSE\n  - MAE\nformat:\n  html:\n    code-fold: true\n---\n\n::: {.callout-tip}\n## What we are solving\nWhy does minimizing the MAE tend towards the median of the sample?\n:::\n\nIn the absence of informative features, an ML algorithm minimizing the sum of squared errors will tend towards predicting the mean of the sample. However, minimizing the sum of absolute errors will tend towards predicting the median of the sample.\n\nThis post dives into why this is the case.\n\n# Minimizing residual sum-of-squares\n\nLet's define the residual for sample $i$ as $\\epsilon_i$. We now want to find the prediction $\\hat{y}$ that minimizes the sum of all squared residuals (i.e. where the gradient is zero):\n\n$$\n\\displaylines{\n\\begin{align}\n\\min_\\hat{y}{\\left[\\sum_{i=1}^N{\\epsilon_i^2}\\right]}\n\\Rightarrow &\n\\frac{\\partial}{\\partial \\hat{y}} \\sum_{i=1}^N{\\epsilon_i^2} \\\\ = &\n\\frac{\\partial \\left( \\sum_{i=1}^N{\\epsilon_i^2} \\right) }{\\partial\\epsilon} \n\\left( \\frac{\\partial\\epsilon}{\\partial \\hat{y} } \\right) \\\\ = &\n\\sum_{i=1}^N 2\\epsilon_i \\left( \\frac{\\partial\\epsilon_i}{\\partial \\hat{y} }\\right) = 0\n\\end{align}\n}\n$$\n\nWe can now substitue in $\\epsilon_i = y - \\hat{y}$:\n\n$$\n\\displaylines{\n\\begin{align}\n\\sum_{i=1}^N 2\\epsilon_i \\left( \\frac{\\partial\\epsilon_i}{\\partial \\hat{y} }\\right) & \n= \\sum_{i=1}^N2( y_i- \\hat{y})\\left(\\frac{\\partial( y_i-\\hat{y})}{\\partial \\hat{y}}\\right) \\\\  & \n= \\sum_{i=1}^N2( y_i- \\hat{y} )(-1) \\\\ &\n= \\sum_{i=1}^N2( y_i) - 2ny = 0 \\\\ & \n\\therefore n \\hat{y} = \\sum_{i=1}^N( y_i) \\\\ & \n\\therefore \\hat{y} = \\frac{\\sum_{i=1}^N{y_i}}{n} = \\bar{y}\n\\end{align}\n}\n$$\n\nThus we can see that the prediction that minimizes the sum of squared residuals, is simply the mean.\n\n# Minimize sum of absolute residuals\n\nWe now do the same think again, but this time look to minimize the sum of all absolute residuals instead.\n\n$$\n\\displaylines{\n\\begin{align}\n\\min_\\hat{y}{\\left[\\sum_{i=1}^N{\\mid \\epsilon_i \\mid}\\right]}\n\\Rightarrow &\n\\frac{\\partial}{\\partial \\hat{y}} \\sum_{i=1}^N{\\left(\\epsilon_i^2\\right)^{1/2}} \\\\ = &\n\\frac{\\partial \\sum_{i=1}^N{ \\left(\\epsilon_i^2\\right)^{1/2} } }{\\partial\\epsilon_i^2}\n\\times \\frac{\\partial\\epsilon_i^2}{\\partial \\epsilon_i }\n\\times \\frac{\\partial\\epsilon_i}{\\partial \\hat{y} }  \\\\ = &\n\\frac{1}{2} \\sum_{i=1}^N{ \\left(\\epsilon_i^2\\right)^{-1/2} }\n\\times 2 \\epsilon_i\n\\times \\frac{\\partial\\epsilon_i}{\\partial \\hat{y} }  \\\\ = &\n\\sum_{i=1}^N{ \\left(\\epsilon_i^2\\right)^{-1/2} } \\times \\epsilon_i\n\\times \\frac{\\partial\\epsilon_i}{\\partial \\hat{y} }  \\\\ = &\n\\sum_{i=1}^N \\frac{\\epsilon_i}{\\mid \\epsilon_i \\mid} \\left( \\frac{\\partial\\epsilon_i}{\\partial \\hat{y} }\\right) = 0\n\\end{align}\n}\n$$\n\nAnd similarly to before, we can now substitute in $\\epsilon_i = y - \\hat{y}$:\n\n$$\n\\displaylines{\n\\begin{align}\n\\sum_{i=1}^N \\frac{\\epsilon_i}{\\mid \\epsilon_i \\mid} \\left( \\frac{\\partial\\epsilon_i}{\\partial \\hat{y} }\\right) & \n= \\sum_{i=1}^N \\frac{ y_i- \\hat{y} }{\\mid y_i- \\hat{y} \\mid}\\left(\\frac{\\partial( y_i-\\hat{y})}{\\partial \\hat{y}}\\right) \\\\  & \n= \\sum_{i=1}^N \\frac{ y_i- \\hat{y} }{\\mid y_i- \\hat{y} \\mid}(-1) = 0\n\\end{align}\n}\n$$\n\nNow $f(x) = \\frac{ x }{\\mid x \\mid}$ is an cool transformation, keeping its sign but getting rid of the magnitude of the size of $x$, i.e.:\n\n* $f(x < 0) = -1$\n* $f(x > 0) = 1$\n\nSo to ensure that $\\sum f(\\epsilon_i)=0$, we need to pick a value for $\\hat{y}$ that means half of the errors are $<0$ and half of the errors are $>0$.\n\nSo that means half the errors must be negative, and half are positive. So $\\hat{y}$ has to be the median value!\n\nFin.\n\n",
    "supporting": [
      "mse_mean_mae_median_files"
    ],
    "filters": [],
    "includes": {}
  }
}